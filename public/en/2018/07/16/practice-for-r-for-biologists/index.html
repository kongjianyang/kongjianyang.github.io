<html><body><a name="top"></a>
<!DOCTYPE html>

<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>KJY</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
<link href="/css/style.css" rel="stylesheet"/>
<link href="/css/fonts.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/bash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/python.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vega@5.17.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4.17.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.12.2"></script>
<script>hljs.initHighlightingOnLoad();</script>
<div class="wrapper">
<header class="header">
<nav class="nav">
<a class="nav-logo" href="/">
<img alt="" height="" src="/media/%3cnil%3e" width=""/>
</a>
<ul class="nav-links">
<li><a href="/">Home</a></li>
<li><a href="/en/about/">About</a></li>
<li><a href="/en/posts/">Posts</a></li>
<li><a href="/cn/posts/">中文</a></li>
</ul>
</nav>
</header>
<main class="content" role="main">
<div style="text-align: center">
<h1>Practice for 'R for Biologists'</h1>
<p>Liang 
 / 2018-07-16 </p>
<hr/>
</div>
<span class="article-toolbar">
<a href="https://github.com/kongjianyang/kongjianyang.github.io/edit/master/content/en/posts/practice-for-r-for-biologists.Rmd" style="font-size: 24px; color: black;" target="_blank"><i aria-hidden="true" class="fa fa-edit" title="Suggest an edit of this page"></i>
</a>
</span>
<div class="body-text list-text">
<div class="section level1" id="part-1-basic">
<h1>Part 1 Basic</h1>
<p>R displays 7 digits by default. You can display more digits with options(). More than 15 digits could be unreliable. This is a <strong>global option</strong>; remains in effect until further notice</p>
<pre class="r"><code>options(digits = 15)
2/3; 2.1^3.1</code></pre>
<pre><code>## [1] 0.666666666666667</code></pre>
<pre><code>## [1] 9.97423999265871</code></pre>
<p>built-in mathematical constants and functions</p>
<pre class="r"><code>2*pi</code></pre>
<pre><code>## [1] 6.28318530717959</code></pre>
<pre class="r"><code>sin(2*pi)</code></pre>
<pre><code>## [1] -2.44929359829471e-16</code></pre>
<pre class="r"><code># This is e
exp(1)               </code></pre>
<pre><code>## [1] 2.71828182845905</code></pre>
<pre class="r"><code>sqrt(2)</code></pre>
<pre><code>## [1] 1.4142135623731</code></pre>
<p>cat() function concatenates strings, inside double quotes, and interpolated values of variables</p>
<pre class="r"><code>x= 2.1
cat("x =", x, "\n")</code></pre>
<pre><code>## x = 2.1</code></pre>
<pre class="r"><code>cat("root2 =", sqrt(2), "\n", "root3 =", sqrt(3), "\n")</code></pre>
<pre><code>## root2 = 1.4142135623731 
##  root3 = 1.73205080756888</code></pre>
</div>
<div class="section level1" id="part-2-help">
<h1>Part 2 Help</h1>
<pre class="r"><code># To see a sequence of simple graphics pictures
demo(graphics)        </code></pre>
<pre><code>## 
## 
##  demo(graphics)
##  ---- ~~~~~~~~
## 
## &gt; #  Copyright (C) 1997-2009 The R Core Team
## &gt; 
## &gt; require(datasets)
## 
## &gt; require(grDevices); require(graphics)
## 
## &gt; ## Here is some code which illustrates some of the differences between
## &gt; ## R and S graphics capabilities.  Note that colors are generally specified
## &gt; ## by a character string name (taken from the X11 rgb.txt file) and that line
## &gt; ## textures are given similarly.  The parameter "bg" sets the background
## &gt; ## parameter for the plot and there is also an "fg" parameter which sets
## &gt; ## the foreground color.
## &gt; 
## &gt; 
## &gt; x &lt;- stats::rnorm(50)
## 
## &gt; opar &lt;- par(bg = "white")
## 
## &gt; plot(x, ann = FALSE, type = "n")</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-4-1.png" width="672"/></p>
<pre><code>## 
## &gt; abline(h = 0, col = gray(.90))
## 
## &gt; lines(x, col = "green4", lty = "dotted")
## 
## &gt; points(x, bg = "limegreen", pch = 21)
## 
## &gt; title(main = "Simple Use of Color In a Plot",
## +       xlab = "Just a Whisper of a Label",
## +       col.main = "blue", col.lab = gray(.8),
## +       cex.main = 1.2, cex.lab = 1.0, font.main = 4, font.lab = 3)
## 
## &gt; ## A little color wheel.    This code just plots equally spaced hues in
## &gt; ## a pie chart.    If you have a cheap SVGA monitor (like me) you will
## &gt; ## probably find that numerically equispaced does not mean visually
## &gt; ## equispaced.  On my display at home, these colors tend to cluster at
## &gt; ## the RGB primaries.  On the other hand on the SGI Indy at work the
## &gt; ## effect is near perfect.
## &gt; 
## &gt; par(bg = "gray")
## 
## &gt; pie(rep(1,24), col = rainbow(24), radius = 0.9)</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-4-2.png" width="672"/></p>
<pre><code>## 
## &gt; title(main = "A Sample Color Wheel", cex.main = 1.4, font.main = 3)
## 
## &gt; title(xlab = "(Use this as a test of monitor linearity)",
## +       cex.lab = 0.8, font.lab = 3)
## 
## &gt; ## We have already confessed to having these.  This is just showing off X11
## &gt; ## color names (and the example (from the postscript manual) is pretty "cute".
## &gt; 
## &gt; pie.sales &lt;- c(0.12, 0.3, 0.26, 0.16, 0.04, 0.12)
## 
## &gt; names(pie.sales) &lt;- c("Blueberry", "Cherry",
## +              "Apple", "Boston Cream", "Other", "Vanilla Cream")
## 
## &gt; pie(pie.sales,
## +     col = c("purple","violetred1","green3","cornsilk","cyan","white"))</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-4-3.png" width="672"/></p>
<pre><code>## 
## &gt; title(main = "January Pie Sales", cex.main = 1.8, font.main = 1)
## 
## &gt; title(xlab = "(Don't try this at home kids)", cex.lab = 0.8, font.lab = 3)
## 
## &gt; ## Boxplots:  I couldn't resist the capability for filling the "box".
## &gt; ## The use of color seems like a useful addition, it focuses attention
## &gt; ## on the central bulk of the data.
## &gt; 
## &gt; par(bg="cornsilk")
## 
## &gt; n &lt;- 10
## 
## &gt; g &lt;- gl(n, 100, n*100)
## 
## &gt; x &lt;- rnorm(n*100) + sqrt(as.numeric(g))
## 
## &gt; boxplot(split(x,g), col="lavender", notch=TRUE)</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-4-4.png" width="672"/></p>
<pre><code>## 
## &gt; title(main="Notched Boxplots", xlab="Group", font.main=4, font.lab=1)
## 
## &gt; ## An example showing how to fill between curves.
## &gt; 
## &gt; par(bg="white")
## 
## &gt; n &lt;- 100
## 
## &gt; x &lt;- c(0,cumsum(rnorm(n)))
## 
## &gt; y &lt;- c(0,cumsum(rnorm(n)))
## 
## &gt; xx &lt;- c(0:n, n:0)
## 
## &gt; yy &lt;- c(x, rev(y))
## 
## &gt; plot(xx, yy, type="n", xlab="Time", ylab="Distance")</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-4-5.png" width="672"/></p>
<pre><code>## 
## &gt; polygon(xx, yy, col="gray")
## 
## &gt; title("Distance Between Brownian Motions")
## 
## &gt; ## Colored plot margins, axis labels and titles.    You do need to be
## &gt; ## careful with these kinds of effects.    It's easy to go completely
## &gt; ## over the top and you can end up with your lunch all over the keyboard.
## &gt; ## On the other hand, my market research clients love it.
## &gt; 
## &gt; x &lt;- c(0.00, 0.40, 0.86, 0.85, 0.69, 0.48, 0.54, 1.09, 1.11, 1.73, 2.05, 2.02)
## 
## &gt; par(bg="lightgray")
## 
## &gt; plot(x, type="n", axes=FALSE, ann=FALSE)</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-4-6.png" width="672"/></p>
<pre><code>## 
## &gt; usr &lt;- par("usr")
## 
## &gt; rect(usr[1], usr[3], usr[2], usr[4], col="cornsilk", border="black")
## 
## &gt; lines(x, col="blue")
## 
## &gt; points(x, pch=21, bg="lightcyan", cex=1.25)
## 
## &gt; axis(2, col.axis="blue", las=1)
## 
## &gt; axis(1, at=1:12, lab=month.abb, col.axis="blue")
## 
## &gt; box()
## 
## &gt; title(main= "The Level of Interest in R", font.main=4, col.main="red")
## 
## &gt; title(xlab= "1996", col.lab="red")
## 
## &gt; ## A filled histogram, showing how to change the font used for the
## &gt; ## main title without changing the other annotation.
## &gt; 
## &gt; par(bg="cornsilk")
## 
## &gt; x &lt;- rnorm(1000)
## 
## &gt; hist(x, xlim=range(-4, 4, x), col="lavender", main="")</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-4-7.png" width="672"/></p>
<pre><code>## 
## &gt; title(main="1000 Normal Random Variates", font.main=3)
## 
## &gt; ## A scatterplot matrix
## &gt; ## The good old Iris data (yet again)
## &gt; 
## &gt; pairs(iris[1:4], main="Edgar Anderson's Iris Data", font.main=4, pch=19)</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-4-8.png" width="672"/></p>
<pre><code>## 
## &gt; pairs(iris[1:4], main="Edgar Anderson's Iris Data", pch=21,
## +       bg = c("red", "green3", "blue")[unclass(iris$Species)])</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-4-9.png" width="672"/></p>
<pre><code>## 
## &gt; ## Contour plotting
## &gt; ## This produces a topographic map of one of Auckland's many volcanic "peaks".
## &gt; 
## &gt; x &lt;- 10*1:nrow(volcano)
## 
## &gt; y &lt;- 10*1:ncol(volcano)
## 
## &gt; lev &lt;- pretty(range(volcano), 10)
## 
## &gt; par(bg = "lightcyan")
## 
## &gt; pin &lt;- par("pin")
## 
## &gt; xdelta &lt;- diff(range(x))
## 
## &gt; ydelta &lt;- diff(range(y))
## 
## &gt; xscale &lt;- pin[1]/xdelta
## 
## &gt; yscale &lt;- pin[2]/ydelta
## 
## &gt; scale &lt;- min(xscale, yscale)
## 
## &gt; xadd &lt;- 0.5*(pin[1]/scale - xdelta)
## 
## &gt; yadd &lt;- 0.5*(pin[2]/scale - ydelta)
## 
## &gt; plot(numeric(0), numeric(0),
## +      xlim = range(x)+c(-1,1)*xadd, ylim = range(y)+c(-1,1)*yadd,
## +      type = "n", ann = FALSE)</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-4-10.png" width="672"/></p>
<pre><code>## 
## &gt; usr &lt;- par("usr")
## 
## &gt; rect(usr[1], usr[3], usr[2], usr[4], col="green3")
## 
## &gt; contour(x, y, volcano, levels = lev, col="yellow", lty="solid", add=TRUE)
## 
## &gt; box()
## 
## &gt; title("A Topographic Map of Maunga Whau", font= 4)
## 
## &gt; title(xlab = "Meters North", ylab = "Meters West", font= 3)
## 
## &gt; mtext("10 Meter Contour Spacing", side=3, line=0.35, outer=FALSE,
## +       at = mean(par("usr")[1:2]), cex=0.7, font=3)
## 
## &gt; ## Conditioning plots
## &gt; 
## &gt; par(bg="cornsilk")
## 
## &gt; coplot(lat ~ long | depth, data = quakes, pch = 21, bg = "green3")</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-4-11.png" width="672"/></p>
<pre><code>## 
## &gt; par(opar)</code></pre>
<pre class="r"><code># To see a sequence of 3D graphics
#demo(persp)           
 
# To list available demonstrations in base package of R
#demo() </code></pre>
<pre class="r"><code># To list all arithmetic operators in R
help(Arithmetic)      
 
# To get help on the log function
help(log)             
 
# To display R help on the plot() function
help(plot)            
 
# Same as help(plot)
?plot                 
 
# To see example of the usage of plot function
example(plot)         </code></pre>
<pre><code>## 
## plot&gt; require(stats) # for lowess, rpois, rnorm
## 
## plot&gt; plot(cars)</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-5-1.png" width="672"/></p>
<pre><code>## 
## plot&gt; lines(lowess(cars))
## 
## plot&gt; plot(sin, -pi, 2*pi) # see ?plot.function</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-5-2.png" width="672"/></p>
<pre><code>## 
## plot&gt; ## Discrete Distribution Plot:
## plot&gt; plot(table(rpois(100, 5)), type = "h", col = "red", lwd = 10,
## plot+      main = "rpois(100, lambda = 5)")</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-5-3.png" width="672"/></p>
<pre><code>## 
## plot&gt; ## Simple quantiles/ECDF, see ecdf() {library(stats)} for a better one:
## plot&gt; plot(x &lt;- sort(rnorm(47)), type = "s", main = "plot(x, type = \"s\")")</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-5-4.png" width="672"/></p>
<pre><code>## 
## plot&gt; points(x, cex = .5, col = "dark red")</code></pre>
<pre class="r"><code># To list all R commands containing the string plot; could be too much info
help.search("plot")   
 
# Same as help.search("plot")
??plot   </code></pre>
<p>: operator has higher predecence than the arithmetical operations.</p>
<pre class="r"><code>sequence_1 = 0 : 10 - 2
print(sequence_1)</code></pre>
<pre><code>##  [1] -2 -1  0  1  2  3  4  5  6  7  8</code></pre>
<pre class="r"><code>sequence_2 = 0 : (10 - 2)
print(sequence_2)</code></pre>
<pre><code>## [1] 0 1 2 3 4 5 6 7 8</code></pre>
<pre class="r"><code>x = seq(from = 0, to = 10, by = 0.5)
square_root_x = sqrt(x)
 
plot(x, square_root_x)</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-7-1.png" width="672"/></p>
</div>
<div class="section level1" id="part-3-graphics">
<h1>Part 3 Graphics</h1>
<pre class="r"><code>x = seq(from =0, to =10, by=0.5)
square_root_x = sqrt(x)
plot(x, square_root_x)</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-8-1.png" width="672"/></p>
<pre class="r"><code># To pause between plots
par(ask = TRUE) 

# To add title
plot(x, square_root_x, main = "My First Plot")                         </code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-8-2.png" width="672"/></p>
<pre class="r"><code># To add label to y-axis
plot(x, square_root_x, main = "My First Plot", ylab = "sqrt(x)")        </code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-8-3.png" width="672"/></p>
<pre class="r"><code># To set limits of y-axis
plot(x, square_root_x, main = "My First Plot", ylab = "sqrt(x)", ylim = c(0, 10))  </code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-8-4.png" width="672"/></p>
<pre class="r"><code># add color
plot(x, square_root_x, main = "my fisrt plot", ylab = "sqrt(x)", ylim = c(0,10), col = "blue")</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-8-5.png" width="672"/></p>
<pre class="r"><code># To over strike with both plotting characters, pch, and connecting lines
plot(x, square_root_x, main = "My First Plot", ylab = "sqrt(x)", ylim = c(0, 10),col = "blue", type = "o")  </code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-8-6.png" width="672"/></p>
<pre class="r"><code># To set the line type
plot(x, square_root_x, main = "My First Plot", ylab = "sqrt(x)", ylim = c(0, 10), col = "blue", type = "o", lty = "dotted") </code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-8-7.png" width="672"/></p>
<pre class="r"><code># To set plotting character 
plot(x, square_root_x, main = "My First Plot", ylab = "sqrt(x)", ylim = c(0, 10), col = "blue", type = "o", lty = "dotted", pch = 22)   </code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-8-8.png" width="672"/></p>
<p>plot() is a high-level plotting function that opens a new plotting window, using low-level functions, one can add to the open plot,some of the commonly used adding functions are: points(), lines(), abline(), legend(), text()</p>
<pre class="r"><code>t = seq(from = 0, to = 10, by = 0.5)
        
# To pause between plots
#par(ask = TRUE)                                           
    
plot(t, sqrt(2 * t), main = "Adding to Plot", sub = "A function and its inverse", xlab = "", ylab = "", xlim = c(0, 10), ylim = c(0, 10), pch = 16, type = "o") 
 
# To add the inverse function
points(t, 0.5 * t * t, col = "red" , pch = 16, type = "o")    
 
# To add the line with intercept = 0, slope = 1
abline(0, 1, col = "gray", lwd = 3, lty = "dashed")      
 
# To add text
text(7, 7.3, "45-degree line", srt = 45)                 
legend("bottomright", legend = c("funtion", "inverse"), pch = 16, col = c("black", "red"))
 
# One can add graphs of mathematical functions using, for example:
x = seq(from =0, to =10, by=0.5)
lines(curve(sin(x) + cos(x) + 5,  add = TRUE))</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-9-1.png" width="672"/></p>
<p>curve() is also a high-level mathematical plotting function that opens a new plotting window, Variable in the mathematical formula must be x, add more graphs by setting add = TRUE</p>
<pre class="r"><code>curve(sin(x), xlim = c(-4*pi, 4*pi), ylim = c(-2, 2), col = "red", ylab = "")
 
# To plot horizontal line using h
abline(h=0, lty= "dotted")    
 
# To mark the origin      
points(0, 0, pch = 3)                
 
curve(cos(x),  col = "blue", add = TRUE) 
curve(sin(x) + cos(x),  col = "purple", lwd = 3, add = TRUE)
 
title("sin(x) + cos(x)")
 
legend("bottomright", legend = c("sin(x)", "cos(x)", "sin(x) + cos(x)"), 
        lty = 1, col = c("red", "blue", "purple"))</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-10-1.png" width="672"/></p>
<p>par() command can set the multi plot environment. mfcol = c(nr,nc) partitions the graphic window as a matrix of nr rows and nc columns, the plots are then drawn in columns. mfrow = c(nr,nc) partitions the graphic window as a matrix of nr rows and nc columns, the plots are then drawn in rows. You can get fancy partitions of the plotting window with layout() function</p>
<pre class="r"><code># Prepare for 2x2 plots, to be filled by rows
par(mfrow = c(2, 2))          
 
t = seq(0, 10, 0.2)
plot(t, sin(t)) 
curve(sinh(x), -5, 5)
curve(tan(x), n = 500, -5, 5)
curve(round(x), n = 500, -5, 5) </code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-11-1.png" width="672"/></p>
<pre class="r"><code># Return to single plot
par(mfrow = c(1, 1))          
 
curve(sin(x), -5, 5) </code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-11-2.png" width="672"/></p>
</div>
<div class="section level1" id="part-4-curve-fitting">
<h1>Part 4 Curve Fitting</h1>
<p>Linear Model function lm(y~x) computes the least square fit line to data points; y as a function of x. Type ?formula for help with legal formulas. lm() can also be used to fit nonlinear models where the parameters enter into model linearly</p>
<pre class="r"><code># fit a line to two data points
x2 = c(1,2)
y2 = c(1.5,2.5)
plot(x2,y2, main = "Unique line through 2 points", xlim = c(0,4), ylim = c(0, 4))

# compute the least square line 

ls_fit_line = lm(y2~x2)
print(ls_fit_line)</code></pre>
<pre><code>## 
## Call:
## lm(formula = y2 ~ x2)
## 
## Coefficients:
## (Intercept)           x2  
##         0.5          1.0</code></pre>
<pre class="r"><code># plot the least square line stored in ls_fit_line
abline(ls_fit_line, col = "red")</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-12-1.png" width="672"/></p>
<pre class="r"><code># plot the vector contain the intercept and slope 
print(coef(ls_fit_line))</code></pre>
<pre><code>## (Intercept)          x2 
##         0.5         1.0</code></pre>
<pre class="r"><code># more information
print(summary(ls_fit_line))</code></pre>
<pre><code>## 
## Call:
## lm(formula = y2 ~ x2)
## 
## Residuals:
## ALL 2 residuals are 0: no residual degrees of freedom!
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)      0.5         NA      NA       NA
## x2               1.0         NA      NA       NA
## 
## Residual standard error: NaN on 0 degrees of freedom
## Multiple R-squared:              1,  Adjusted R-squared:            NaN 
## F-statistic:           NaN on 1 and 0 DF,  p-value: NA</code></pre>
<pre class="r"><code># Compute least-square line fit for 3 data points
x3 = c(1, 2, 3)
y3 = c(1.5, 2.5, 2.8)
 
plot(x3, y3, main="Best-fit line through 3 points", xlim=c(0, 4), ylim = c(0, 4)) 
fit3 = lm(y3 ~ x3)
abline(fit3, col = "red")</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-13-1.png" width="672"/></p>
<pre class="r"><code>print(fit3)</code></pre>
<pre><code>## 
## Call:
## lm(formula = y3 ~ x3)
## 
## Coefficients:
##    (Intercept)              x3  
## 0.966666666667  0.650000000000</code></pre>
<pre class="r"><code>print(summary(fit3))</code></pre>
<pre><code>## 
## Call:
## lm(formula = y3 ~ x3)
## 
## Residuals:
##               1               2               3 
## -0.116666666667  0.233333333333 -0.116666666667 
## 
## Coefficients:
##                   Estimate     Std. Error t value Pr(&gt;|t|)
## (Intercept) 0.966666666667 0.436526695124 2.21445  0.27003
## x3          0.650000000000 0.202072594216 3.21667  0.19188
## 
## Residual standard error: 0.285773803325 on 1 degrees of freedom
## Multiple R-squared:  0.911870503597, Adjusted R-squared:  0.823741007194 
## F-statistic: 10.3469387755 on 1 and 1 DF,  p-value: 0.191883024573</code></pre>
<pre class="r"><code># Compute the parabola through 3 data points
 
plot(x3, y3, main="Unique parabola through 3 points", xlim=c(0, 6), ylim = c(0, 6)) 
fit_parabola3 = lm(y3 ~ x3 + I(x3^2))
print(fit_parabola3 )</code></pre>
<pre><code>## 
## Call:
## lm(formula = y3 ~ x3 + I(x3^2))
## 
## Coefficients:
## (Intercept)           x3      I(x3^2)  
##       -0.20         2.05        -0.35</code></pre>
<pre class="r"><code>curve(coef(fit_parabola3)[1] + coef(fit_parabola3)[2]* x + coef(fit_parabola3)[3]*x^2, 0, 6, col = "red", add=TRUE)</code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-15-1.png" width="672"/></p>
<pre class="r"><code># Compute a best-fit parabola for 4 data points
 
x4 = c(1, 2, 3, 4)
y4 = c(1.5, 2.5, 2.8, 1.7)
 
plot(x4, y4, main="Best-fit parabola through 4 points", xlim=c(0, 6), ylim = c(0, 6)) 
fit_parabola4 = lm(y4 ~ x4 + I(x4^2))
curve(coef(fit_parabola4)[1] + coef(fit_parabola4)[2]* x + coef(fit_parabola4)[3]*x^2, 0, 6, col = "red", add=TRUE)
 
# Add the predicted points
points(x4, predict(fit_parabola4), col = "green") </code></pre>
<p><img src="/en/2018-07-16-practice-for-r-for-biologists_files/figure-html/unnamed-chunk-16-1.png" width="672"/></p>
<pre class="r"><code>print(fit_parabola4)</code></pre>
<pre><code>## 
## Call:
## lm(formula = y4 ~ x4 + I(x4^2))
## 
## Coefficients:
## (Intercept)           x4      I(x4^2)  
##      -0.725        2.715       -0.525</code></pre>
</div>
<p style="color:#777;">Last modified on 2018-07-16</p>
</div>
<a href="#top"><i class="fa fa-chevron-up" style="font-size: 30px; color: black;"></i></a>
</main>
<footer class="footer">
<script async="" crossorigin="anonymous" issue-term="pathname" repo="kongjianyang/kongjianyang.github.io" src="https://utteranc.es/client.js" theme="github-light">
</script>
<script src="/js/math-code.js" type="text/javascript"></script>
<script async="" src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="/js/center-img.js" type="text/javascript"></script>
<ul class="footer-links">
<li><a href="/en/posts/index.xml" title="RSS feed" type="application/rss+xml">
       Subscribe </a>
</li>
<li>
<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
       
        License
        <i aria-hidden="true" class="fa fa-cc" title="Attribution-NonCommercial-ShareAlike 4.0 International"></i>
</a>
</li>
</ul>
<div class="copyright-text">
            
            ©
            
            KJY
            
            2018-2021
            
     </div>
</footer>
</div></body></html>